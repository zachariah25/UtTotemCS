<!DOCTYPE html>

<html lang="en">
<head>
	<!-- Mobile Specific Metas
  ================================================== -->
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<!-- CSS
  ================================================== -->
	<link rel="stylesheet" href="stylesheets/base.css">
	<link rel="stylesheet" href="stylesheets/skeleton.css">
	<link rel="stylesheet" href="stylesheets/layout.css">

	<link href="jquery-ui.css" rel="stylesheet" type="text/css">
	<link href="style.css" rel="stylesheet" type="text/css">

	<title>Turtle Wax -- Logo-ish Turtle Graphics for HTML5 Canvas</title>
	<script src="jquery.js"></script>
	<script src="jquery-ui.js"></script>
  	
	<script>

	$(function() {
	    $(".draggable").draggable({
	        connectToSortable: "#selectedList",
	        helper: "clone",
	        revert: "invalid"
	    });
	    $("#selectedList").sortable({
	        
	        revert: true
	    });
	    $("ul, li").disableSelection();
	});

  	</script>

</head>

<body>


<div class="container">
	<p><h1>Write your own recursion!</h1></p>

    <div class="one-third column">
    	<p><h2>Available commands</h2></p>
    	<ul id="commandList" class="connectedSortable"></ul>
    </div>
    <div class="one-third column">
    	<p><h2>Drag commands here</h2></p>
    	<ul id="selectedList" class="connectedSortable">
  			<li class="ui-state-highlight">p.go(length);</li>
		</ul>
		
	</div>
    <div class="one-third column">
    	<p><h2>Run it!</h2></p>
    	<button onclick="drawOnCanvas()" type="button">Click Me!</button>
    	<canvas id="mycanvas" height="600" width="800">
    </div>
</div>


<!-- including the lib and an rgb to hsv color util function -->
<script src="pen.js"></script>
<script src="hsv.js"></script>


<script>
	var p = new Pen("mycanvas");

	var cmds = new Array();
	cmds[0] = "p.go(length);"					// forward
	cmds[1] = "p.go(-length);"					// backward
	cmds[2] = "p.turn(90);"						// turn right 90
	cmds[3] = "p.turn(-90);"					// turn left 90
	cmds[4] = "p.turtle(depth-1,length/2);"		// recurse
	
	

    // Get command list reference
	var cmdList = document.getElementById("commandList");

	var listElement;
	var cmdToAddValue;

	// Let's add these commands to the list
	for (var i = 0; i < cmds.length; i++) {
		listElement = document.createElement("li");
		listElement.setAttribute('class', 'draggable ui-state-default');
		cmdToAddValue = document.createTextNode(cmds[i]);
		listElement.appendChild(cmdToAddValue);
		cmdList.appendChild(listElement);
	}


	// actual drawing code
	p.turtle = function(depth, length) {

		if (depth <= 0) {
			return;
		}

		// For IE / other platform support
    	var text = "textContent" in document ? "textContent" : "innerText";

		var cmdsToExecuteList = document.getElementById("selectedList");
		var cmdsToExecute = cmdsToExecuteList.getElementsByTagName("li");

		for (var i = 0; i < cmdsToExecute.length; i++) {
			eval(cmdsToExecute[i][text]);
		}

		/*
		p.turn(90)
		p.go(length);
		p.turtle(depth-1,length/2);
		p.go(-(length))
		p.turn(-90);
		*/


		/*
		eval(cmds[2]);
		eval(cmds[0]);
		eval(cmds[4]);
		eval(cmds[1]);
		eval(cmds[3]);
		*/
	};

	function drawOnCanvas() {
		// clear canvas and go to origin
		//ctx.clearRect(0,0,canvas.width,canvas.height)
		p.goto(200, 200).fillstyle("#fff");
		p.origin().pendown();

		// start our drawing
		p.turtle(7, 200);

		p.close().draw();
	}
	
</script>
</body>
</html>